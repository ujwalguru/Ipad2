<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
  <title>PDF Viewer • Minimal Dark</title>
  <style>
    /* Minimal dark theme, compatible with older Safari */
    html, body {
      height: 100%;
      margin: 0;
      background: #0f0f12;
      color: #e8e8ec;
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
    }

    .wrap {
      height: 100%;
      width: 100%;
      display: -webkit-box;       /* old iOS support */
      display: -webkit-flex;
      display: flex;
      -webkit-box-orient: vertical;
      -webkit-box-direction: normal;
      -webkit-flex-direction: column;
              flex-direction: column;
    }

    .topbar {
      background: #141419;
      border-bottom: 1px solid rgba(255,255,255,0.08);
      padding: 10px 12px;
      -webkit-flex: 0 0 auto;
              flex: 0 0 auto;
    }

    .row {
      display: -webkit-box;
      display: -webkit-flex;
      display: flex;
      -webkit-box-align: center;
      -webkit-align-items: center;
              align-items: center;
      -webkit-box-pack: justify;
      -webkit-justify-content: space-between;
              justify-content: space-between;
      gap: 10px; /* ignored on very old, harmless */
    }

    .title {
      font-size: 16px;
      opacity: 0.9;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .btns {
      white-space: nowrap;
    }

    button, .btn {
      background: #1d1d25;
      color: #f0f0f5;
      border: 1px solid rgba(255,255,255,0.12);
      padding: 8px 12px;
      margin: 0 6px 0 0;
      border-radius: 8px;
      font-size: 14px;
      cursor: pointer;
    }
    button:active, .btn:active { opacity: 0.85; }

    .note {
      margin-top: 8px;
      font-size: 13px;
      color: #bfc1cc;
    }

    .viewer {
      -webkit-flex: 1 1 auto;
              flex: 1 1 auto;
      min-height: 200px;
      position: relative;
      background: #0b0b0f;
    }

    /* Use both iframe and object for broader compatibility; we toggle via JS */
    .hidden { display: none !important; }

    iframe, object {
      width: 100%;
      height: 100%;
      border: 0;
      background: transparent;
    }

    .fallback {
      position: absolute;
      inset: 0;
      padding: 16px;
      color: #c7c9d3;
      background: #0b0b0f;
    }

    footer {
      -webkit-flex: 0 0 auto;
              flex: 0 0 auto;
      padding: 10px 12px;
      font-size: 13px;
      color: #9fa3b2;
      border-top: 1px solid rgba(255,255,255,0.08);
      background: #141419;
      text-align: center;
    }

    /* Responsive niceties */
    @media (orientation: landscape) and (max-height: 480px) {
      .title { font-size: 14px; }
      button { padding: 6px 10px; font-size: 13px; }
    }
  </style>
</head>
<body>
  <div class="wrap">
    <div class="topbar">
      <div class="row">
        <div class="title" id="pageTitle">PDF Preview</div>
        <div class="btns">
          <button id="openFullBtn" aria-label="Open Fullscreen">Open Fullscreen</button>
          <button id="downloadBtn" aria-label="Download PDF">Download</button>
        </div>
      </div>
      <div class="note hidden" id="iosNote">Use <strong>Open Fullscreen</strong> → <strong>Share</strong> → <strong>Open in iBooks.</strong></div>
    </div>

    <div class="viewer" id="viewer">
      <!-- Two renderers; we will prefer <iframe> and fall back to <object> -->
      <iframe id="pdfFrame" class="hidden" allowfullscreen></iframe>
      <object id="pdfObject" class="hidden" type="application/pdf">
        <div class="fallback" id="fallback">
          <p>Cannot display the PDF inline in this browser.</p>
          <p><a id="fallbackLink" class="btn" href="#" target="_blank">Open PDF</a></p>
        </div>
      </object>
    </div>

    <footer>Made by Ujwal Guru.</footer>
  </div>

  <script>
    // ES5-only JavaScript (compatible with iOS 9 Safari)
    (function () {
      // === Configuration ===
      // Set your PDF file path here (relative or absolute). Keep it simple (no spaces) for old iOS.
      var PDF_URL = 'sample.pdf'; // ← Replace with your actual PDF file name

      // Append a basic view hint to fit width where supported.
      var pdfUrlWithParams = PDF_URL + '#view=FitH&zoom=page-width';

      // === Dom refs ===
      var openBtn = document.getElementById('openFullBtn');
      var downloadBtn = document.getElementById('downloadBtn');
      var frame = document.getElementById('pdfFrame');
      var obj = document.getElementById('pdfObject');
      var viewer = document.getElementById('viewer');
      var iosNote = document.getElementById('iosNote');
      var fallbackLink = document.getElementById('fallbackLink');

      // Basic UA sniffing for iOS Safari (works on iOS 9.3.5 on iPad 2)
      var ua = navigator.userAgent || '';
      var isIOS = /(iPad|iPhone|iPod)/.test(ua);
      var isCriOS = /CriOS/.test(ua); // Chrome on iOS
      var isFxiOS = /FxiOS/.test(ua); // Firefox on iOS
      var isSafari = /Safari\//.test(ua) && !isCriOS && !isFxiOS;
      var isIOSSafari = isIOS && isSafari;

      // Show the iOS-specific helper note only on iOS Safari
      if (isIOSSafari) {
        iosNote.className = iosNote.className.replace('hidden', '').replace(/\s+$/, '');
      }

      // Try to use iframe first; some old Safari versions prefer direct navigation instead of embedding
      function tryEmbed() {
        var used = false;
        try {
          // Prefer iframe
          frame.src = pdfUrlWithParams;
          frame.className = frame.className.replace('hidden', '').replace(/\s+$/, '');
          obj.className = obj.className.indexOf('hidden') === -1 ? (obj.className + ' hidden') : obj.className;
          used = true;
        } catch (e) {}

        // Set up <object> as a secondary renderer and as a host for our fallback message
        try {
          obj.data = PDF_URL;
          obj.type = 'application/pdf';
          // Keep it hidden if iframe is active; otherwise show it
          if (!used) {
            obj.className = obj.className.replace('hidden', '').replace(/\s+$/, '');
          }
        } catch (e2) {}

        // Fallback link always available
        fallbackLink.href = PDF_URL;
      }

      function openFullscreen() {
        // On iOS Safari, navigating directly to the PDF opens the native viewer (best experience)
        if (isIOSSafari) {
          window.location.href = PDF_URL;
          return;
        }

        // Otherwise, try Fullscreen API on the iframe or its container
        var el = frame && frame.parentNode ? frame.parentNode : viewer;
        var req = el.requestFullscreen || el.webkitRequestFullscreen || el.webkitRequestFullScreen || el.msRequestFullscreen || el.mozRequestFullScreen;
        if (req) {
          try { req.call(el); } catch (e) { window.open(PDF_URL, '_blank'); }
        } else {
          // Fallback: open in a new tab/window
          window.open(PDF_URL, '_blank');
        }
      }

      function downloadPDF() {
        // Create a temporary link; note: iOS Safari ignores download attribute, but other browsers will use it.
        var a = document.createElement('a');
        a.href = PDF_URL;
        a.target = '_blank';
        // Guard: only set download when supported (primitive check)
        if (typeof a.download !== 'undefined') {
          a.download = PDF_URL.split('/').pop();
        }
        document.body.appendChild(a);
        if (a.click) { a.click(); } else {
          // Very old fallback
          var evt = document.createEvent('MouseEvents');
          evt.initEvent('click', true, true);
          a.dispatchEvent(evt);
        }
        setTimeout(function(){ if (a && a.parentNode) { a.parentNode.removeChild(a); } }, 0);
      }

      function sizeViewer() {
        // Explicitly size the viewer to the visible viewport, subtracting topbar and footer heights.
        // This avoids iOS Safari quirks with 100vh in portrait.
        var topbar = document.getElementsByClassName('topbar')[0];
        var footer = document.getElementsByTagName('footer')[0];
        var h = window.innerHeight || document.documentElement.clientHeight || document.body.clientHeight;
        var used = 0;
        if (topbar) { used += topbar.offsetHeight; }
        if (footer) { used += footer.offsetHeight; }
        var target = h - used;
        if (target < 200) { target = 200; }
        viewer.style.height = target + 'px';
      }

      // Wire up events
      openBtn.addEventListener('click', openFullscreen, false);
      downloadBtn.addEventListener('click', downloadPDF, false);
      window.addEventListener('resize', sizeViewer, false);
      window.addEventListener('orientationchange', sizeViewer, false);

      // Init
      tryEmbed();
      sizeViewer();
    })();
  </script>
</body>
</html>
